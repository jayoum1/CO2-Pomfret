<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pomfret Forest Growth & Carbon Simulation</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Animated Clouds -->
    <div class="cloud cloud-1"></div>
    <div class="cloud cloud-2"></div>
    <div class="cloud cloud-3"></div>
    <div class="cloud cloud-4"></div>
    <div class="cloud cloud-5"></div>

    <!-- Navigation -->
    <nav class="nav-bar">
        <div class="nav-container">
            <a href="#hero" class="nav-link">Home</a>
            <a href="#measured" class="nav-link">Data</a>
            <a href="#model" class="nav-link">Model</a>
            <a href="#accuracy" class="nav-link">Accuracy</a>
            <a href="#simulation" class="nav-link">Simulation</a>
            <a href="#features" class="nav-link">Features</a>
            <a href="#results" class="nav-link">Results</a>
            <a href="#app-link" class="nav-link">App</a>
        </div>
    </nav>

    <!-- Hero Section - Huge Title Centered -->
    <section id="hero" class="hero">
        <div class="container">
            <h1 class="hero-title">CO₂ Pomfret</h1>
            <p class="hero-subtitle">Simulating forest carbon sequestration to compare with Pomfret School emissions.</p>
            <div class="chips">
                <span class="chip">DBH (cm)</span>
                <span class="chip">Baseline Growth Curves</span>
                <span class="chip">Stochastic Mode</span>
                <span class="chip">Multi-year snapshots</span>
                <span class="chip">Forest Modification</span>
            </div>
        </div>
    </section>

    <!-- What We Measured -->
    <section id="measured" class="section">
        <div class="container">
            <h2 class="section-title">What We Measured</h2>
            <div class="content-box">
                <div class="measured-content">
                    <div class="measured-list">
                        <ul>
                            <li><strong>TreeID</strong> — Unique tree identifier</li>
                            <li><strong>Plot</strong> — Forest location (Upper/Middle/Lower)</li>
                            <li><strong>Species</strong> — Tree species (e.g., sugar maple, red oak)</li>
                            <li><strong>DBH_cm</strong> — Diameter at breast height (cm)</li>
                            <li><strong>Carbon</strong> — Derived from DBH using allometric equations (kg C)</li>
                        </ul>
                    </div>
                    <div class="diagram">
                        <svg viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg">
                            <!-- Data Box -->
                            <rect x="20" y="80" width="80" height="40" rx="5" class="diagram-box"/>
                            <text x="60" y="105" text-anchor="middle" class="diagram-text">Data</text>
                            
                            <!-- Arrow 1 -->
                            <path d="M 100 100 L 140 100" stroke="currentColor" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
                            
                            <!-- Model Box -->
                            <rect x="140" y="80" width="80" height="40" rx="5" class="diagram-box"/>
                            <text x="180" y="105" text-anchor="middle" class="diagram-text">Model</text>
                            
                            <!-- Arrow 2 -->
                            <path d="M 220 100 L 260 100" stroke="currentColor" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
                            
                            <!-- Snapshots Box -->
                            <rect x="260" y="80" width="80" height="40" rx="5" class="diagram-box"/>
                            <text x="300" y="105" text-anchor="middle" class="diagram-text">Snapshots</text>
                            
                            <!-- Arrow 3 -->
                            <path d="M 340 100 L 380 100" stroke="currentColor" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
                            
                            <!-- App Box -->
                            <rect x="380" y="80" width="80" height="40" rx="5" class="diagram-box"/>
                            <text x="420" y="105" text-anchor="middle" class="diagram-text">App</text>
                            
                            <!-- Arrow marker definition -->
                            <defs>
                                <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                    <polygon points="0 0, 10 3, 0 6" fill="currentColor"/>
                                </marker>
                            </defs>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Model Section -->
    <section id="model" class="section section-alt">
        <div class="container">
            <h2 class="section-title">Growth Model</h2>
            <div class="content-box">
                <div class="model-content">
                    <div class="model-text">
                        <p class="model-description">
                            <strong>Baseline Growth Curves</strong> predict annual DBH growth from historical data, 
                            fitted by species, plot, and tree size. Growth rates are learned from observed increments 
                            and constrained with a high-DBH guardrail to prevent unrealistic growth at large diameters.
                        </p>
                        <div class="model-details">
                            <h3 class="model-subtitle">How It Works</h3>
                            <ul class="model-list">
                                <li><strong>Binned Statistics:</strong> Growth curves are fitted using trimmed means/medians at species+plot level</li>
                                <li><strong>Fallback Hierarchy:</strong> Species-only → Global curves when plot-specific data is sparse</li>
                                <li><strong>High-DBH Guardrail:</strong> Prevents unrealistic increasing growth at large diameters</li>
                                <li><strong>Year-by-Year Simulation:</strong> Iteratively applies one-year growth predictions</li>
                            </ul>
                        </div>
                        <div class="performance-metrics">
                            <div class="metric">
                                <span class="metric-label">Model Type</span>
                                <span class="metric-value">Baseline Curves</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Stochastic Mode</span>
                                <span class="metric-value">Available</span>
                            </div>
                            <div class="metric">
                                <span class="metric-label">Horizons</span>
                                <span class="metric-value">0, 5, 10, 20 years</span>
                            </div>
                        </div>
                    </div>
                    <div class="model-diagram">
                        <svg viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
                            <!-- Data Input -->
                            <g class="layer">
                                <rect x="30" y="50" width="100" height="60" rx="5" class="diagram-box"/>
                                <text x="80" y="80" text-anchor="middle" class="diagram-text">Historical</text>
                                <text x="80" y="100" text-anchor="middle" class="diagram-text">DBH Data</text>
                            </g>
                            
                            <!-- Arrow 1 -->
                            <path d="M 130 80 L 170 80" stroke="currentColor" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
                            
                            <!-- Curve Fitting -->
                            <g class="layer">
                                <rect x="170" y="50" width="100" height="60" rx="5" class="diagram-box"/>
                                <text x="220" y="80" text-anchor="middle" class="diagram-text">Binned</text>
                                <text x="220" y="100" text-anchor="middle" class="diagram-text">Statistics</text>
                            </g>
                            
                            <!-- Arrow 2 -->
                            <path d="M 270 80 L 310 80" stroke="currentColor" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
                            
                            <!-- Growth Curves -->
                            <g class="layer">
                                <rect x="310" y="50" width="100" height="60" rx="5" class="diagram-box"/>
                                <text x="360" y="80" text-anchor="middle" class="diagram-text">Growth</text>
                                <text x="360" y="100" text-anchor="middle" class="diagram-text">Curves</text>
                            </g>
                            
                            <!-- Growth Curve Visualization -->
                            <g class="layer">
                                <path d="M 80 200 Q 150 180, 220 170 T 360 160" stroke="#14b8a6" stroke-width="3" fill="none"/>
                                <text x="220" y="250" text-anchor="middle" class="diagram-text-small">DBH Growth Rate</text>
                                <text x="220" y="270" text-anchor="middle" class="diagram-text-small">decreases with size</text>
                            </g>
                            
                            <!-- Arrow marker definition -->
                            <defs>
                                <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                    <polygon points="0 0, 10 3, 0 6" fill="currentColor"/>
                                </marker>
                            </defs>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Model Accuracy Section -->
    <section id="accuracy" class="section">
        <div class="container">
            <h2 class="section-title">Model Accuracy</h2>
            <div class="content-box">
                <div class="accuracy-content">
                    <div class="accuracy-text">
                        <p class="accuracy-headline">
                            <strong>Precise Predictions, Transparent Uncertainty</strong>
                        </p>
                        <p class="accuracy-description">
                            Our growth curve model provides highly accurate carbon sequestration predictions. 
                            For each tree, typical prediction uncertainty is quantified and converted to 
                            everyday terms you can understand.
                        </p>
                        <div class="accuracy-metric-box">
                            <div class="accuracy-metric">
                                <div class="accuracy-value">
                                    <span class="accuracy-number">~9.4</span>
                                    <span class="accuracy-unit">kg CO₂e/year</span>
                                </div>
                                <div class="accuracy-label">Per-tree typical deviation</div>
                            </div>
                            <div class="accuracy-equivalent">
                                <div class="car-icon-container">
                                    <svg class="car-icon" viewBox="0 0 200 100" xmlns="http://www.w3.org/2000/svg">
                                        <!-- Car body -->
                                        <rect x="30" y="50" width="140" height="40" rx="5" fill="#14b8a6" opacity="0.9"/>
                                        <!-- Car roof -->
                                        <path d="M 50 50 L 80 30 L 120 30 L 150 50" fill="#14b8a6" opacity="0.9"/>
                                        <!-- Windows -->
                                        <rect x="55" y="35" width="20" height="15" rx="2" fill="#ffffff" opacity="0.6"/>
                                        <rect x="125" y="35" width="20" height="15" rx="2" fill="#ffffff" opacity="0.6"/>
                                        <!-- Wheels -->
                                        <circle cx="60" cy="90" r="12" fill="#1e293b"/>
                                        <circle cx="60" cy="90" r="8" fill="#64748b"/>
                                        <circle cx="140" cy="90" r="12" fill="#1e293b"/>
                                        <circle cx="140" cy="90" r="8" fill="#64748b"/>
                                        <!-- Wheel rims -->
                                        <circle cx="60" cy="90" r="4" fill="#e2e8f0"/>
                                        <circle cx="140" cy="90" r="4" fill="#e2e8f0"/>
                                        <!-- Headlights -->
                                        <circle cx="170" cy="60" r="5" fill="#fbbf24" opacity="0.8"/>
                                        <!-- Exhaust -->
                                        <ellipse cx="25" cy="65" rx="8" ry="4" fill="#64748b" opacity="0.5"/>
                                    </svg>
                                </div>
                                <div class="equivalent-text">
                                    <span class="equivalent-label">≈</span>
                                    <span class="equivalent-value">23 miles</span>
                                    <span class="equivalent-unit">driven/year</span>
                                </div>
                            </div>
                        </div>
                        <p class="accuracy-explanation">
                            Each data point is typically about <strong>9.4 kg CO₂e</strong> (equivalent to 
                            <strong>23 miles</strong> of car driving) away from what our growth curve predicts. 
                            This represents natural variation in tree growth, not model error—our predictions 
                            are calibrated from historical data and account for real-world biological variability.
                        </p>
                        <div class="accuracy-badge">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                                <path d="M2 17l10 5 10-5"/>
                                <path d="M2 12l10 5 10-5"/>
                            </svg>
                            <span>Statistically validated uncertainty estimates</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Simulation Section -->
    <section id="simulation" class="section">
        <div class="container">
            <h2 class="section-title">Simulation</h2>
            <div class="content-box">
                <div class="simulation-content">
                    <div class="simulation-text">
                        <p>
                            We generate multi-year forest snapshots at <strong>0, 5, 10, and 20 years</strong> ahead by iteratively applying the baseline growth model year-by-year.
                        </p>
                        <p class="simulation-modes">
                            <strong>Two Simulation Modes:</strong>
                        </p>
                        <ul class="modes-list">
                            <li>
                                <strong>Baseline Mode (Default):</strong> Uses deterministic growth curves for stable, biologically plausible projections. 
                                Each tree's DBH is updated year-by-year using species and plot-specific growth rates.
                            </li>
                            <li>
                                <strong>Visual Mode (Stochastic):</strong> Adds calibrated random variation from historical residual spread. 
                                Improves visual realism by showing natural growth variability, but does not claim improved accuracy.
                            </li>
                        </ul>
                    </div>
                    <div class="assumptions-box">
                        <h3 class="assumptions-title">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="12" y1="16" x2="12" y2="12"/>
                                <line x1="12" y1="8" x2="12.01" y2="8"/>
                            </svg>
                            Assumptions
                        </h3>
                        <ul class="assumptions-list">
                            <li>DBH in centimeters (cm)</li>
                            <li>Growth-only baseline (no mortality/disturbance)</li>
                            <li>High-DBH guardrail prevents unrealistic growth</li>
                            <li>Year-by-year iterative simulation</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="section section-alt">
        <div class="container">
            <h2 class="section-title">App Features</h2>
            <div class="content-box">
                <div class="features-content">
                    <div class="feature-item">
                        <div class="feature-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                                <path d="M2 17l10 5 10-5"/>
                                <path d="M2 12l10 5 10-5"/>
                            </svg>
                        </div>
                        <h3 class="feature-title">Forest Modification</h3>
                        <p class="feature-description">
                            Simulate tree planting and removal scenarios to understand their impact on carbon sequestration. 
                            Plant trees by species, plot, and size class, or remove existing trees to model cutting scenarios. 
                            See how your modifications affect carbon storage over 5, 10, and 20 years.
                        </p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2"/>
                                <path d="M3 9h18M9 3v18"/>
                            </svg>
                        </div>
                        <h3 class="feature-title">Area Generalizer</h3>
                        <p class="feature-description">
                            Scale carbon sequestration results from our measured plots to any target area. 
                            Use manual area input or draw polygons on an interactive map to calculate 
                            forest carbon densities and project sequestration for your specific area.
                        </p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">
                            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="2" x2="12" y2="22"/>
                                <polyline points="19 15 12 8 5 15"/>
                            </svg>
                        </div>
                        <h3 class="feature-title">Interactive Dashboard</h3>
                        <p class="feature-description">
                            Explore forest snapshots at different time horizons with interactive charts showing 
                            total carbon storage, carbon by plot, and mean DBH over time. Toggle between 
                            baseline and stochastic simulation modes.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Results Section -->
    <section id="results" class="section section-alt">
        <div class="container">
            <h2 class="section-title">Results</h2>
            <div class="content-box">
                <div class="results-grid">
                    <div class="result-item">
                        <div class="result-image-container">
                            <img src="figures/total_carbon_vs_years.png" alt="Total Carbon vs Years" class="result-image" onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'400\' height=\'300\'%3E%3Crect fill=\'%23f0f0f0\' width=\'400\' height=\'300\'/%3E%3Ctext x=\'50%25\' y=\'50%25\' text-anchor=\'middle\' dominant-baseline=\'middle\' fill=\'%23999\' font-family=\'system-ui\' font-size=\'14\'%3EDrop total_carbon_vs_years.png into midterm_site/figures/%3C/text%3E%3C/svg%3E';">
                        </div>
                        <p class="result-caption">Total Carbon vs Years</p>
                    </div>
                    <div class="result-item">
                        <div class="result-image-container">
                            <img src="figures/mean_dbh_vs_years.png" alt="Mean DBH vs Years" class="result-image" onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'400\' height=\'300\'%3E%3Crect fill=\'%23f0f0f0\' width=\'400\' height=\'300\'/%3E%3Ctext x=\'50%25\' y=\'50%25\' text-anchor=\'middle\' dominant-baseline=\'middle\' fill=\'%23999\' font-family=\'system-ui\' font-size=\'14\'%3EDrop mean_dbh_vs_years.png into midterm_site/figures/%3C/text%3E%3C/svg%3E';">
                        </div>
                        <p class="result-caption">Mean DBH vs Years</p>
                    </div>
                    <div class="result-item">
                        <div class="result-image-container">
                            <img src="figures/dbh_distribution_by_year.png" alt="DBH Distribution by Year" class="result-image" onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'400\' height=\'300\'%3E%3Crect fill=\'%23f0f0f0\' width=\'400\' height=\'300\'/%3E%3Ctext x=\'50%25\' y=\'50%25\' text-anchor=\'middle\' dominant-baseline=\'middle\' fill=\'%23999\' font-family=\'system-ui\' font-size=\'14\'%3EDrop dbh_distribution_by_year.png into midterm_site/figures/%3C/text%3E%3C/svg%3E';">
                        </div>
                        <p class="result-caption">DBH Distribution by Year</p>
                    </div>
                    <div class="result-item">
                        <div class="result-image-container">
                            <img src="figures/carbon_by_plot_over_time.png" alt="Carbon by Plot Over Time" class="result-image" onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'400\' height=\'300\'%3E%3Crect fill=\'%23f0f0f0\' width=\'400\' height=\'300\'/%3E%3Ctext x=\'50%25\' y=\'50%25\' text-anchor=\'middle\' dominant-baseline=\'middle\' fill=\'%23999\' font-family=\'system-ui\' font-size=\'14\'%3EDrop carbon_by_plot_over_time.png into midterm_site/figures/%3C/text%3E%3C/svg%3E';">
                        </div>
                        <p class="result-caption">Carbon by Plot Over Time</p>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <!-- App Link Section -->
    <section id="app-link" class="section">
        <div class="container">
            <div class="content-box app-cta">
                <h2 class="section-title">Try the Interactive App</h2>
                <p style="text-align: center; font-size: 1.25rem; color: var(--text-muted); margin-bottom: 2rem;">
                    Explore the full interactive dashboard with planting scenarios, visualizations, and real-time simulations.
                </p>
                <div style="text-align: center;">
                    <a href="http://localhost:3000" class="app-link-button" target="_blank" rel="noopener noreferrer">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                            <polyline points="15 3 21 3 21 9"></polyline>
                            <line x1="10" y1="14" x2="21" y2="3"></line>
                        </svg>
                        Open CO₂ Pomfret App
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p class="footer-text">
                <span class="footer-name">Jay</span> • 
                <span class="footer-date">Jan 8</span> • 
                <span class="footer-school">Pomfret School</span>
            </p>
        </div>
    </footer>

    <script>
        // Smooth scroll for navigation links
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetSection = document.querySelector(targetId);
                if (targetSection) {
                    targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Scroll-triggered animations for sections and content boxes
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };

        const sectionObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, observerOptions);

        const boxObserver = new IntersectionObserver((entries) => {
            entries.forEach((entry, index) => {
                if (entry.isIntersecting) {
                    setTimeout(() => {
                        entry.target.classList.add('visible');
                    }, index * 100); // Stagger animation
                }
            });
        }, {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        });

        // Observe all sections
        document.querySelectorAll('.section').forEach(section => {
            sectionObserver.observe(section);
        });

        // Observe all content boxes
        document.querySelectorAll('.content-box').forEach(box => {
            boxObserver.observe(box);
        });

        // Observe result items individually for staggered effect
        document.querySelectorAll('.result-item').forEach((item, index) => {
            boxObserver.observe(item);
        });

        // Show/hide navigation bar based on scroll position
        const navBar = document.querySelector('.nav-bar');
        const heroSection = document.querySelector('.hero');
        
        window.addEventListener('scroll', () => {
            const heroBottom = heroSection.offsetTop + heroSection.offsetHeight;
            const scrollPosition = window.pageYOffset || window.scrollY;
            
            // Show nav bar after scrolling past the hero section
            if (scrollPosition > heroBottom - 100) {
                navBar.classList.add('visible');
            } else {
                navBar.classList.remove('visible');
            }
        });

        // Highlight active nav link on scroll
        const sections = document.querySelectorAll('.section, .hero');
        const navLinks = document.querySelectorAll('.nav-link');

        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.pageYOffset >= sectionTop - 150) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
